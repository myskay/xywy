<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>首页</title>
		<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"> 
		<link rel="stylesheet" type="text/css" href="css/initialize.css"/>
		<link rel="stylesheet" type="text/css" href="css/common.css"/>
		<link rel="stylesheet" type="text/css" href="css/index.css"/>
		<script src="js/jquery.js"></script>
		<script src="js/common.js"></script>
		<script src="js/echarts.js"></script>
		<script src="js/forget.js"></script>
	</head>
	<body>
		<!--导航栏-->
		<header>
			<div class="header-con">
				<div class="header-logo">
				   <a href="#"><img src="img/shouye-logo.png"/></a>
			    </div>
			    <div class="search">
			    	<img src="img/sousuo.png" id="search-box"/>
			    </div>
			    <!--搜索框-->
			   <div id="sb-search" class="sb-search">
			    			<form>
			    				<input class="sb-search-input" placeholder="请输入用户名或手机号"  type="text" value="" name="search" id="search"/>
			    				<input class="sb-search-submit" type="submit" value="" />
			    				<span class="sb-icon-search"><img src="img/white-sousuo.png"/></span>
			    			</form>
			    </div>
			    <ul class="header-nav">
			    	<li><a href="index.html" >首页</a></li>
			    	<li><a href="user-manage.html">用户管理</a></li>
			    	<li><a href="wtist-meter.html">设备管理</a></li>
			    	<li><a href="todo-sos.html">工单管理</a></li>
			    	<li><a href="startup.html">运营管理</a></li>
			    	<li><a href="service-list.html">系统管理</a></li>
			    	<li><a href="useradd-count.html">数据统计</a></li>
			    </ul>
			    <div class="header-personal">
			    	<div class="upload">
			    		<!--<input type="file" name="file" title="Change" class="form-control doc " multiple="multiple" id="doc">-->
			    		<img src="img/touxiang.png" class="img1"/>
			    	</div>
			    	<div class="personal">
			    		<p class="name">吃吃</p>
			    		<p class="role">角色:<span>客服组</span></p>
			    	</div>
			    	<div style="clear: both;"></div>
			    		<ul class="personal-xiala">
			    		    <li class="gaimima"><a href="#">修改密码</a></li>
			    		    <li class="quit"><a href="#">退出登录</a></li>
			    	    </ul>
			    </div>
			    <div style="clear: both;"></div>
			</div>
		</header>
		<!--导航栏结束-->
		<section class="main-cotent">
			<div class="con-in">
				<div class="in-part blue">
					<div class="part-con">
						<p class="num">100</p>
						<p class="name"><a>今日注册量</a></p>
					</div>
				</div>
				<div class="in-part yellow">
					<div class="part-con">
						<p class="num">300</p>
						<p class="name"><a>在线人数</a></p>
					</div>
				</div>
				<div class="in-part purple">
					<div class="part-con">
						<p class="num">6</p>
						<p class="name"><a>本周用户意见反馈量</a></p>
					</div>
				</div>
				<div class="in-part pink">
					<div class="part-con">
						<p class="num">2</p>
						<p class="name"><a>今日紧急sos报警量</a></p>
					</div>
				</div>
				<div style="clear: both;"></div>
			</div>
		</section>
		<section class="todo-list">
			<div class="list-title">
				<span class="circle"></span>
				<span class="title-name">待处理事项</span>
			</div>
			<ul class="list-con">
				<li>
					<div class="con-in">
						<p class="num">1</p>
						<p class="name"><a>紧急sos报警</a></p>
					</div>
				</li>
				<li>
					<div class="con-in">
						<p class="num">1</p>
						<p class="name"><a>客户端用户反馈</a></p>
					</div>
				</li>
				<li>
					<div class="con-in">
						<p class="num">1</p>
						<p class="name"><a>紧急sos报警</a></p>
					</div>
				</li>
				<div style="clear: both;"></div>
			</ul>
		</section>
		<section class="todo-list">
			<div class="list-title">
				<div class="title-in">
					<span class="circle"></span>
				    <span class="title-name">新增用户</span>
				</div>
				<ul class="anniu-jihe" id="add-jihe">
				    <li id="add-week"><a class="active">本周</a></li>
				    <li id="add-month"><a>本月</a></li>
				    <li id="add-year"><a>本年</a></li>
			    </ul>
			    <div style="clear: both;"></div>
			</div> 
			<div class="list-content">
				<div id="main" style="height: 500px;"></div>
			</div>
		</section>
		<section class="todo-list">
			<div class="list-title">
				<div class="title-in">
					<span class="circle"></span>
				    <span class="title-name">在线人数统计图</span>
				</div>
				<ul class="anniu-jihe" id="on-jihe">
				    <li id="on-week"><a class="active">本周</a></li>
				    <li id="on-month"><a>本月</a></li>
				    <li id="on-year"><a>本年</a></li>
			    </ul>
			    <div style="clear: both;"></div>
			</div> 
			<div class="list-content">
				<div id="side" style="height: 500px;"></div>
			</div>
		</section>
		<!--修改密码弹窗-->
		<div class="revise-overlay">
	        <div class="revise-content">
		         <div class="con-title">
			        <span class="">修改密码</span>
			        <img src="img/guanbi.png" class="close"/>
		         </div>
		         <div class="container">
			        <form class="form-signin">
				         <div class="login-wrap">
					       <input type="text" class="form-text tel-box" placeholder="请输入绑定的手机号" maxlength="11" id="tel-box">
				        </div>
				        <div class="mask">
					        <div class="code-alert">获取验证码成功</div>
				        </div>
				       <div class="login-else">
					        <input type="text" placeholder="请输入验证码" class="form-text test-code" id="code-box">
					        <button class="getcode" type="button" id="send">发送</button>
				       </div>

				       <p class="alert-box"></p>
				       <div class="login-else login-pwd">
					       <input type="password" placeholder="请输入新密码" class="form-text test-code" id="pwd1">
					       <button class="getcode" type="button" id="showhidePwd"></button>
				       </div>
				       <div class="login-else login-text">
					       <input type="text" placeholder="请输入新密码" class="form-text test-code" id="pwd2">
					       <button class="getcode" type="button" id="hideshowPwd"></button>
				       </div>
				       <input type="submit" value="确定" class="login">
			        </form>
		        </div>
	        </div>
        </div>
		<!--退出登录弹窗-->
		<div class="quit-overlay">
			<div class="quit-content">
		         <div class="con-title">
			        <span class="">退出登录</span>
			        <img src="img/guanbi.png" class="close"/>
		         </div>
		         <div class="quit-con">
		   	        <p>确定要退出后台系统吗?</p>
		   	        <div class="quit-jihe">
		   	           <button class="sure">确认</button>
		   	           <button class="cancel">返回</button>
		   	        </div>
		        </div>
		  </div>
		</div>
        <!--悬浮提醒框-->	
        <div class="warner-box">
        	<a href="#">
        	   <img src="img/warner (2).png" />
        	   <span>4</span>
        	</a>
        </div>
        <!--悬浮提醒框结束-->
<script>
//			新增人数统计图
			var mychart = echarts.init(document.getElementById("main"));
			mychart.setOption({
				tooltip:{
					trigger:'axis'
				},
				toolbox:{
					orient:'vertical',
					show:true,
					feature:{
						dataZoom:{
							yAxisIndex:'none'
						},
						dataView:{readOnly:false},
						magicType:{type:['line','bar']},
						restore:{},
						saveAsImage:{}
					},
					left:'right',
					top:'center'
				},
				legend:{
					data:[
					  {
					  	name:'新增人数'
					  }
					],
					left:'right'
				},
				xAxis:{
					type:"category",
					boundaryGap:false,
					axisLine:{
						lineStyle:{
//							color:'#ccc'
						}
					},
					data:[]
				},
				yAxis:{
					splitLine:{
						lineStyle:{
							type:'dashed'
						}
					},
					axisLine:{
						lineStyle:{
//							color:'#ccc'
						}
					}
				},
				series:[
				   {
				   	name:'新增人数',
				   	type:'line',
				   	smooth:true,
				   	showAllSymbol:'emptyCircle',
				   	symbolSize:15,
				   	data:[],
				   	itemStyle:{
				   		"normal":{
				   			color:'rgba(151,187,205,1)'				
				   		}
				   	},
				   	markPoint:{
				   		data:[
				   		  {type:'max',name:'最大值'},
				   		  {type:'min',name:'最小值'}
				   		]
				   	},
				   	markLine:{
				   		data:[
				   		   {type:'average',name:'平均值'}
				   		]
				   	},
				   	areaStyle:{
				   		normal:{
				   			color:new echarts.graphic.LinearGradient(0,0,0,1,[{
				   				offset:0,
				   				color:'rgba(151,187,205,0.5)'
				   			},{
				   				offset:1,
				   				color:'rgba(151,187,205,0.2)'
				   			}],false)
				   		}
				   	}
				   }
				]
			});
			mychart.showLoading();
			var week = [];
			var maxtemp = [];
			var url = 'mysql/weektemp.php';
			var stop = false;
			function getData(url){
				$.ajax({
					type:"post",
					url:url,
					async:true,
					data:{},
					dataType:'json',
					success:function(result){
						if(result){
							for(var i = 0;i < result.length;i ++){
								week.push(result[i].week);
							}
							for(var i = 0;i < result.length;i ++){
								maxtemp.push(result[i].maxtemp);
							}
							mychart.hideLoading();
							mychart.setOption({
								xAxis:{
									data:week
								},
								series:[
								   {
								   	data:maxtemp
								   }
								]
							});
							week.splice(0,week.length);
							maxtemp.splice(0,maxtemp.length);
						}
						stop  = true;
					},
					error:function(errorMsg){
						alert('图表请求失败');
						mychart.hideLoading();
					}
				});
			};
			getData(url);
			$("#add-week").click(function(){
				$("#add-jihe li a").removeClass('active');
				$(this).find("a").addClass("active");
				if(stop){
					url = "mysql/weektemp.php";
					getData(url);
				}
			});
			$("#add-month").click(function(){
				$("#add-jihe li a").removeClass('active');
				$(this).find("a").addClass("active");
				if(stop){
					url = "mysql/monthtemp.php";
					getData(url);
				}
			});
			$("#add-year").click(function(){
				$("#add-jihe li a").removeClass('active');
				$(this).find("a").addClass("active");
				if(stop){
					url = "mysql/monthtemp.php";
					getData(url);
				}
			})
//			在线人数统计图
            var chartelse = echarts.init(document.getElementById("side"));
            chartelse.setOption({
            	legend:{
            		data:[
            		    {name:'在线人数'}
            		],
            		left:'right'
            	},
            	tooltip:{
					trigger:'item'
				},
				toolbox:{
					show:true,
					feature:{
						dataZoom:{
							yAxisIndex:'none'
						},
						dataView:{readOnly:false},
						magicType:{type:['line','bar']},
						restore:{},
						saveAsImage:{}
					},
					left:'right',
					top:'center',
					orient:'vertical'
				},
				xAxis:{
					type:"category",
					boundaryGap:false,
					data:[],
					splitLine:{
						lineStyle:{
							type:'dashed'
						}
					}
				},
				yAxis:{
					splitLine:{
						lineStyle:{
							type:'dashed'
						}
					},
					scale:true,
					axisLine:{
						lineStyle:{
//							color:'#ccc'
						}
					}
				},
				series:[
				   {
				   	name:'在线人数',
				   	type:'scatter',
				   	data:[],
				   	symbolSize:30,
				   	itemStyle:{
				   		normal:{
				   			shadowBlur:10,
				   			shadowColor:'rgba(120,36,50,0.5)',
				   			shadowOffsetY:5,
				   			color:new echarts.graphic.RadialGradient(0.4,0.3,1,[{
				   				offset:'0',
				   				color:'rgb(251,118,123)'
				   			},{
				   				offset:'1',
				   				color:'rgb(204,46,72)'
				   			}])
				   		}
				   	}
				   }
				]
           });
           chartelse.showLoading();
           var day1 = [];
           var num1 = [];
           var count = false;
           var url1 = 'mysql/addpreson.php';
           function getshuju(url1){
           	$.ajax({
           		type:"post",
           		url:url1,
           		async:true,
           		data:{},
           		dataType:'json',
           		success:function(result){
           			if(result){
           				for(var i = 0;i < result.length;i ++){
           					day1.push(result[i].day);
           				}
           				for(var i = 0;i < result.length;i++){
           					num1.push(result[i].num);
           				}
           				chartelse.hideLoading();
           				chartelse.setOption({
           					xAxis:{
           						data:day1
           					},
           					series:[
           					  {
           					  	data:num1
           					  }
           					]
           				});
           				day1.splice(0,day1.length);
           				num1.splice(0,num1.length);
           			}
           			count = true;
           		},
           		error:function(errorMsg){
           			alert('图表数据请求失败');
           			chartelse.hideLoading();
           		}
           	});
           };
           getshuju(url1);
           $("#on-week").click(function(){
           	 $("#on-jihe li a").removeClass('active');
           	 $(this).find("a").addClass("active");
           	if(count){
           		url1 = "mysql/addpreson.php";
           		getshuju(url1);
           	}
           });
            $("#on-month").click(function(){
           	 $("#on-jihe li a").removeClass('active');
           	 $(this).find("a").addClass("active");
           	if(count){
           		url1 = "mysql/addpreson.php";
           		getshuju(url1);
           	}
           });
            $("#on-year").click(function(){
           	 $("#on-jihe li a").removeClass('active');
           	 $(this).find("a").addClass("active");
           	if(count){
           		url1 = "mysql/addpreson.php";
           		getshuju(url1);
           	}
           });
		</script>
	</body>
</html>
